/* Base accordion styles */
.accordion {
  @apply w-full;

  /* Performance optimization - contain layout changes */
  contain: layout style;
}

/* Accordion elements */
.accordion__body {
  /* Body is now just a wrapper for the grid animation */
}

.accordion__body-inner {
  @apply text-muted px-4 pb-4 pt-0;
}

.accordion__heading {
  @apply flex;
}

.accordion__indicator {
  @apply text-muted ml-auto size-4 shrink-0 transition duration-300;

  /* Expanded state for indicator rotation */
  &[data-expanded="true"] {
    @apply -rotate-180;
  }
}

.accordion__item {
  @apply border-b last:border-b-0;
}

.accordion__trigger {
  cursor: var(--cursor-interactive);

  /* Base Styles */
  @apply flex flex-1 items-center justify-between px-4 py-4 text-left font-medium transition-[background-color,opacity] duration-[50ms] ease-out;

  /* Hover state */
  &:hover,
  &[data-hover="true"],
  /* Pressed state */
  &[data-pressed="true"] {
    background-color: color-mix(in oklab, var(--color-foreground) 6%, transparent 90%);
  }

  /* Focus state */
  &:focus-visible,
  &[data-focus-visible="true"] {
    outline: 2px solid var(--focus);
    outline-offset: 2px;
  }

  /* Disabled State */
  &:disabled {
    @apply pointer-events-none cursor-not-allowed opacity-[var(--disabled-opacity)];
  }
}

/* Performant Grid-based animation wrapper */
.accordion__panel {
  display: grid;
  grid-template-rows: 0fr;
  transition: grid-template-rows 300ms var(--ease-soft-in-out);

  .accordion__body {
    overflow: hidden;
  }

  /* Expanded state */
  &[data-expanded="true"] {
    grid-template-rows: 1fr;
  }
}

/* Outline variant */
.accordion--outline {
  @apply bg-panel rounded-lg border shadow-sm;

  .accordion__trigger {
    &:hover,
    &[data-hover="true"] {
      @apply bg-panel-hover;
    }
  }
}

.accordion--outline .accordion__item {
  /* Special rounding for first and last items in outline variant */
  &:first-child [data-accordion-trigger] {
    @apply rounded-t-lg;
  }

  &:last-child:not(:has([data-accordion-trigger][aria-expanded="true"])) [data-accordion-trigger] {
    @apply rounded-b-lg;
  }
}
